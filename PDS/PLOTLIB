./ ADD NAME=HDCPY    0100-80001-80001-1200-00003-00003-00000-PLOTLIB 00
      SUBROUTINE HDCPY(A)
      RETURN
      END
./ ADD NAME=NEWPAG   0100-80001-80001-1200-00003-00003-00000-PLOTLIB 00
      SUBROUTINE NEWPAG
      RETURN
      END
./ ADD NAME=NUMBER   0100-80001-80001-1200-00001-00001-00000-PLOTLIB 00
                                                                           7.1
./ ADD NAME=PLAXIS   0100-80001-80001-1200-00074-00074-00000-PLOTLIB 00
      SUBROUTINE AXIS(XPAGE,YPAGE,IBCD,NCHAR,AXLEN,ANGLE,FIRSTV,DELTAV)
C  AXIS     COPYRIGHT 1967 CALIFORNIA COMPUTER PRODUCTS         V097
C.....     XPAGE,YPAGE  COORDINATES OF STARTING POINT OF AXIS, IN INCHES
C.....     IBCD         AXIS TITLE.
C.....     NCHAR        NUMBER OF CHARACTERS IN TITLE. + FOR C.C-W SIDE.
C.....     AXLEN        FLOATING POINT AXIS LENGTH IN INCHES.
C.....     ANGLE        ANGLE OF AXIS FROM THE X-DIRECTION, IN DEGREES.
C.....     FIRSTV       SCALE VALUE AT THE FIRST TIC MARK.
C.....     DELTAV       CHANGE IN SCALE BETWEEN TIC MARKS ONE INCH APART
      DIMENSION IBCD(2)
      KN=NCHAR
      A=1.0
      IF (KN) 1,2,2
  1   A=-A
      KN=-KN
  2   EX=0.0
      ADX= ABS  (DELTAV)
      IF (ADX) 3,7,3
  3   IF (ADX-100.0) 6,4,4
  4   ADX=ADX/10.0
      EX=EX+1.0
      GO TO 3
  5   ADX=ADX*10.0
      EX=EX-1.0
  6   IF (ADX-0.01) 5,7,7
  7   XVAL=FIRSTV*10.0**(-EX)
      ADX= DELTAV*10.0**(-EX)
      STH=ANGLE*0.0174533
      CTH=COS(STH)
      STH=SIN(STH)
      DXB=-0.1
      DYB=0.15*A-0.05
      XN=XPAGE+DXB*CTH-DYB*STH
      YN=YPAGE+DYB*CTH+DXB*STH
      NTIC=AXLEN+1.0
      NT=NTIC/2
      DO  20  I=1,NTIC
        CALL NUMBER(XN,YN,0.1,XVAL,ANGLE,2)
        XVAL=XVAL+ADX
        XN=XN+CTH
        YN=YN+STH
        IF (NT) 20,11,20
 11       Z=KN
          IF (EX)  12,13,12
 12       Z=Z+7.0
 13       DXB=-.07*Z+AXLEN*0.5
          DYB=0.325*A-0.075
          XT=XPAGE+DXB*CTH-DYB*STH
          YT=YPAGE+DYB*CTH+DXB*STH
          CALL SYMBOL(XT,YT,0.14,IBCD(1),ANGLE,KN)
          IF (EX)  14,20,14
 14         Z=KN+2
            XT=XT+Z*CTH*0.14
            YT=YT+Z*STH*0.14
            CALL SYMBOL(XT,YT,0.14,1550938112,ANGLE,3)
            XT=XT+(3.0*CTH-0.8*STH)*0.14
            YT=YT+(3.0*STH+0.8*CTH)*0.14
            CALL NUMBER(XT,YT,0.07,EX,ANGLE,-1)
 20   NT=NT-1
      CALL PLOT(XPAGE+AXLEN*CTH,YPAGE+AXLEN*STH,3)
      DXB=-0.07*A*STH
      DYB=+0.07*A*CTH
      A=NTIC-1
      XN=XPAGE+A*CTH
      YN=YPAGE+A*STH
      DO  30  I=1,NTIC
        CALL PLOT(XN,YN,2)
        CALL PLOT(XN+DXB,YN+DYB,2)
        CALL PLOT(XN,YN,2)
        XN=XN-CTH
        YN=YN-STH
 30   CONTINUE
      RETURN
      END
./ ADD NAME=PLLINE   0100-80001-80001-1200-00058-00058-00000-PLOTLIB 00
      SUBROUTINE LINE (XARRAY,YARRAY,NPTS,INC,LINTYP,INTEQ)
C  LINE     COPYRIGHT 1967 CALIFORNIA COMPUTER PRODUCTS         V097
C.....     XARRAY  NAME OF ARRAY CONTAINING ABSCISSA OR X VALUES.
C.....     YARRAY  NAME OF ARRAY CONTAINING ORDINATE OF Y VALUES.
C.....     NPTS    NUMBER OF POINTS TO BE PLOTTED.
C.....     INC     INCREMENT OF LOCATION OF SUCCESSIVE POINTS.
C.....     LINTYP  CONTROL TYPE OF LINE--SYMBOLS, LINE, OR COMBINATION.
C.....     INTEQ   INTEGER EQUIVALENT OF SYMBOL TO BE USED, IF ANY.
      DIMENSION XARRAY(1),YARRAY(1)
      LMIN = NPTS*INC+1
      LDX  = LMIN+INC
      NL   = LMIN-INC
      FIRSTX = XARRAY(LMIN)
      DELTAX = XARRAY(LDX)
      FIRSTY = YARRAY(LMIN)
      DELTAY = YARRAY(LDX)
      CALL WHERE (XN,YN,DF)
      XN = XN*DELTAX+FIRSTX
      YN = YN*DELTAY+FIRSTY
      DF = AMAX1(ABS(XARRAY( 1)-XN),ABS(YARRAY( 1)-YN))
      DL = AMAX1(ABS(XARRAY(NL)-XN),ABS(YARRAY(NL)-YN))
      IPEN = 3
      ICODE = -1
      NT =IABS(LINTYP)
      IF (LINTYP) 7,6,7
    6 NT = 1
    7 IF (DF-DL) 9,9,8
    8 NF = NL
      NA = ((NPTS-1)/NT)*NT+NT-(NPTS-1)
      KK = -INC
      GO TO 10
    9 NF = 1
      NA = NT
      KK = INC
   10 IF (LINTYP) 11,12,13
   11 IPENA = 3
      ICODEA = -1
      LSW = 1
      GO TO 15
   12 NA=LDX
   13 IPENA = 2
      ICODEA = -2
      LSW=0
   15 DO 30 I =1,NPTS
      XN = (XARRAY(NF)-FIRSTX)/DELTAX
      YN = (YARRAY(NF)-FIRSTY)/DELTAY
      IF (NA-NT) 20,21,22
   20 IF (LSW) 23,22,23
   21 CALL SYMBOL (XN,YN,0.08,INTEQ,0.0,ICODE)
      NA = 1
      GO TO 25
   22 CALL PLOT (XN,YN,IPEN)
   23 NA = NA + 1
   25 NF = NF+KK
      ICODE = ICODEA
   30 IPEN = IPENA
      RETURN
      END
./ ADD NAME=PLOT     0100-80001-80001-1200-00116-00116-00000-PLOTLIB 00
      SUBROUTINE PLPLOT(X,Y,IPEN)
      INTEGER*2 CHAR(3)/' ','.','*'/
      INTEGER*2 GRID(350,132)
      COMMON/PLOTB/GRID,XVIRT,YVIRT,XPOS,YPOS,XSCALE,YSCALE,XMAX,YMAX,
     1ITAG,IERRO,LINES,MLINES
      IF(ITAG.EQ.0) GO TO 10
   13 XNEW=X+XVIRT
      YNEW=Y+YVIRT
      IF(XNEW.GT.XMAX.OR.XNEW.LT.0.) GO TO 70
      IF(YNEW.GT.YMAX.OR.YNEW.LT.0.) GO TO 70
      LTEST=XNEW/XSCALE+1
      IF(LTEST.GE.LINES) LINES=LTEST
C
C     PROCESS THE ALTERNATIVES
      IF(IPEN.EQ.-4) GO TO 20
      IF(IPEN.EQ.-3) GO TO 30
      IF(IPEN.EQ. 3) GO TO 40
      IF(IPEN.EQ.-2) GO TO 50
      IF(IPEN.EQ. 2) GO TO 60
      WRITE(6,300)
      IERRO=IERRO+1
      IF(IERRO.GT.20) GO TO 80
      RETURN
C
C     ITAG =0 WILL INITIALIZE ALL VALUES, EXECUTE ONLY ON 1ST CALL
   10 XVIRT=0.
      YVIRT=0.
      ITAG=1
      LINES=1
      XPOS=0.
      YPOS=0.
      DO 11 I=1,MLINES
      DO 11 J=1,132
   11 GRID(I,J)=CHAR(1)
      XSCALE=8.68E0/5.2E1
      YSCALE=1E-1
      XMAX=(MLINES-1)*XSCALE
      YMAX=131E0*YSCALE
      WRITE(6,500) XMAX,YMAX
      GO TO 13
C
C     CALL OF -4, TO DRAW THE PLOT AND REINITIALIZE
   20 LINES=LINES+1
      XANEW=FLOAT(LINES-2)*XSCALE
      WRITE(6,700) XANEW,LINES
      WRITE(6,100)
      DO 12 I=1,LINES
   12 WRITE(6,200)(GRID(I,J),J=1,132)
      WRITE(6,100)
      ITAG=0
      RETURN
C
C     CALL OF -3 TO SET A NEW PLOT VIRTUAL ORIGIN
   30 XVIRT=XNEW
      YVIRT=YNEW
      XPOS=XNEW
      YPOS=YNEW
      RETURN
C
C     CALL OF 3 TO GO TO THE NEW POINT, WITHOUT DRAWING LINE
   40 XPOS=XNEW
      YPOS=YNEW
      RETURN
C
C     CALL OF -2, DARK VECTOR TO A NEW ORIGIN
   50 XVIRT=XNEW
      YVIRT=YNEW
C
C     CALL OF 2, DRAW THE DARK VECTOR
   60 XANEW=XNEW/XSCALE
      YANEW=YNEW/YSCALE
      XAPOS=XPOS/XSCALE
      YAPOS=YPOS/YSCALE
      XAINCR=XANEW-XAPOS
      YAINCR=YANEW-YAPOS
      DIVID=AMAX1(ABS(XAINCR),ABS(YAINCR))
      IF(DIVID.LT.0.3) RETURN
      XAINCR=XAINCR/DIVID
      YAINCR=YAINCR/DIVID
      IXMEM=XAPOS
      IYMEM=YAPOS
      DO 61 I=1,3000
          IXAPOS=XAPOS+1
          IYAPOS=YAPOS+1
          IF(GRID(IXAPOS,IYAPOS).NE.CHAR(1)) GOTO 63
   64 GRID(IXAPOS,IYAPOS)=CHAR(2)
          IXMEM=IXAPOS
          IYMEM=IYAPOS
          GO TO 65
   63     IF(IXMEM.EQ.IXAPOS.AND.IYMEM.EQ.IYAPOS) GO TO 64
          GRID(IXAPOS,IYAPOS)=CHAR(3)
   65     IF(ABS(XANEW-XAPOS).LE.1E0.AND.ABS(YANEW-YAPOS).LE.1E0)GOTO62
          XAPOS=XAPOS+XAINCR
   61     YAPOS=YAPOS+YAINCR
   62 XPOS=XNEW
      YPOS=YNEW
      RETURN
C
C     DONE. PRINT ERRORS AND FORMATS
   70 WRITE(6,400)X,Y,XNEW,YNEW,IPEN
      IERRO=IERRO+1
      IF(IERRO.GT.20) GO TO 80
      RETURN
   80 WRITE(6,600)
      STOP
C
  100 FORMAT('1')
  200 FORMAT(1X,132A1)
  300 FORMAT(' ***ERROR*** IMPROPER IPEN OPTION')
  400 FORMAT(' ***ERROR*** PLOT VALUE OUT OF RANGE. X = ',F7.3,' Y = ',
     1F7.3,' ACTUAL X = ',F7.3,' ACTUAL Y = ',F7.3,' PEN POSITION =',I3)
  500 FORMAT(1X,'MAXIMUM X = ',F7.3,' INCHES. MAXIMUM Y = ',F7.3,
     1' INCHES.')
  600 FORMAT(' ***ERROR*** EXECUTION TERMINATING. TOO MANY ERRORS.')
  700 FORMAT(' LARGEST X CALLED =',F8.3,' USING',I6,' LINES OF OUTPUT')
      END
./ ADD NAME=PLPLOT   0100-80001-80001-1200-00116-00116-00000-PLOTLIB 00
      SUBROUTINE PLPLOT(X,Y,IPEN)
      INTEGER*2 CHAR(3)/' ','.','*'/
      INTEGER*2 GRID(350,132)
      COMMON/PLOTB/GRID,XVIRT,YVIRT,XPOS,YPOS,XSCALE,YSCALE,XMAX,YMAX,
     1ITAG,IERRO,LINES,MLINES
      IF(ITAG.EQ.0) GO TO 10
   13 XNEW=X+XVIRT
      YNEW=Y+YVIRT
      IF(XNEW.GT.XMAX.OR.XNEW.LT.0.) GO TO 70
      IF(YNEW.GT.YMAX.OR.YNEW.LT.0.) GO TO 70
      LTEST=XNEW/XSCALE+1
      IF(LTEST.GE.LINES) LINES=LTEST
C
C     PROCESS THE ALTERNATIVES
      IF(IPEN.EQ.-4) GO TO 20
      IF(IPEN.EQ.-3) GO TO 30
      IF(IPEN.EQ. 3) GO TO 40
      IF(IPEN.EQ.-2) GO TO 50
      IF(IPEN.EQ. 2) GO TO 60
      WRITE(6,300)
      IERRO=IERRO+1
      IF(IERRO.GT.20) GO TO 80
      RETURN
C
C     ITAG =0 WILL INITIALIZE ALL VALUES, EXECUTE ONLY ON 1ST CALL
   10 XVIRT=0.
      YVIRT=0.
      ITAG=1
      LINES=1
      XPOS=0.
      YPOS=0.
      DO 11 I=1,MLINES
      DO 11 J=1,132
   11 GRID(I,J)=CHAR(1)
      XSCALE=8.68E0/5.2E1
      YSCALE=1E-1
      XMAX=(MLINES-1)*XSCALE
      YMAX=131E0*YSCALE
      WRITE(6,500) XMAX,YMAX
      GO TO 13
C
C     CALL OF -4, TO DRAW THE PLOT AND REINITIALIZE
   20 LINES=LINES+1
      XANEW=FLOAT(LINES-2)*XSCALE
      WRITE(6,700) XANEW,LINES
      WRITE(6,100)
      DO 12 I=1,LINES
   12 WRITE(6,200)(GRID(I,J),J=1,132)
      WRITE(6,100)
      ITAG=0
      RETURN
C
C     CALL OF -3 TO SET A NEW PLOT VIRTUAL ORIGIN
   30 XVIRT=XNEW
      YVIRT=YNEW
      XPOS=XNEW
      YPOS=YNEW
      RETURN
C
C     CALL OF 3 TO GO TO THE NEW POINT, WITHOUT DRAWING LINE
   40 XPOS=XNEW
      YPOS=YNEW
      RETURN
C
C     CALL OF -2, DARK VECTOR TO A NEW ORIGIN
   50 XVIRT=XNEW
      YVIRT=YNEW
C
C     CALL OF 2, DRAW THE DARK VECTOR
   60 XANEW=XNEW/XSCALE
      YANEW=YNEW/YSCALE
      XAPOS=XPOS/XSCALE
      YAPOS=YPOS/YSCALE
      XAINCR=XANEW-XAPOS
      YAINCR=YANEW-YAPOS
      DIVID=AMAX1(ABS(XAINCR),ABS(YAINCR))
      IF(DIVID.LT.0.3) RETURN
      XAINCR=XAINCR/DIVID
      YAINCR=YAINCR/DIVID
      IXMEM=XAPOS
      IYMEM=YAPOS
      DO 61 I=1,3000
          IXAPOS=XAPOS+1
          IYAPOS=YAPOS+1
          IF(GRID(IXAPOS,IYAPOS).NE.CHAR(1)) GOTO 63
   64 GRID(IXAPOS,IYAPOS)=CHAR(2)
          IXMEM=IXAPOS
          IYMEM=IYAPOS
          GO TO 65
   63     IF(IXMEM.EQ.IXAPOS.AND.IYMEM.EQ.IYAPOS) GO TO 64
          GRID(IXAPOS,IYAPOS)=CHAR(3)
   65     IF(ABS(XANEW-XAPOS).LE.1E0.AND.ABS(YANEW-YAPOS).LE.1E0)GOTO62
          XAPOS=XAPOS+XAINCR
   61     YAPOS=YAPOS+YAINCR
   62 XPOS=XNEW
      YPOS=YNEW
      RETURN
C
C     DONE. PRINT ERRORS AND FORMATS
   70 WRITE(6,400)X,Y,XNEW,YNEW,IPEN
      IERRO=IERRO+1
      IF(IERRO.GT.20) GO TO 80
      RETURN
   80 WRITE(6,600)
      STOP
C
  100 FORMAT('1')
  200 FORMAT(1X,132A1)
  300 FORMAT(' ***ERROR*** IMPROPER IPEN OPTION')
  400 FORMAT(' ***ERROR*** PLOT VALUE OUT OF RANGE. X = ',F7.3,' Y = ',
     1F7.3,' ACTUAL X = ',F7.3,' ACTUAL Y = ',F7.3,' PEN POSITION =',I3)
  500 FORMAT(1X,'MAXIMUM X = ',F7.3,' INCHES. MAXIMUM Y = ',F7.3,
     1' INCHES.')
  600 FORMAT(' ***ERROR*** EXECUTION TERMINATING. TOO MANY ERRORS.')
  700 FORMAT(' LARGEST X CALLED =',F8.3,' USING',I6,' LINES OF OUTPUT')
      END
./ ADD NAME=PLSCALE  0100-80001-80001-1200-00060-00060-00000-PLOTLIB 00
      SUBROUTINE  SCALE   (ARRAY,AXLEN,NPTS,INC)
C  SCALE    COPYRIGHT 1967 CALIFORNIA COMPUTER PRODUCTS         V097
C.....     ARRAY   NAME OF ARRAY CONTAINING VALUES TO BE SCALED.
C.....     AXLEN   LENGTH IN INCHES OVER WHICH ARRAY IS TO BE SCALED.
C.....     NPTS    NUMBER OF POINTS TO BE SCALED.
C.....     INC     INCREMENT OF LOCATION OF SUCCESSIVE POINTS.
      DIMENSION  ARRAY(1),SAVE(7)
      SAVE(1)=1.0
      SAVE(2)=2.0
      SAVE(3)=4.0
      SAVE(4)=5.0
      SAVE(5)=8.0
      SAVE(6)=10.0
      SAVE(7)=20.
      FAD=0.01
      K=IABS(INC)
      N=NPTS*K
      Y0=ARRAY(1)
      YN=Y0
      DO  25  I=1,N,K
      YS=ARRAY(I)
      IF  (Y0-YS)  22,22,21
21    Y0=YS
      GO  TO  25
22    IF  (YS-YN)  25,25,24
24    YN=YS
25    CONTINUE
      FIRSTV=Y0
      IF  (Y0)  34,35,35
34    FAD=FAD-1.0
35    DELTAV=(YN-FIRSTV)/AXLEN
      IF (DELTAV) 70,70,40
40    I=ALOG10(DELTAV)+1000.0
      P=10.0**(I-1000)
      DELTAV=DELTAV/P-0.01
      DO  45  I=1,6
      IS=I
      IF  (SAVE(I)-DELTAV)  45,50,50
45    CONTINUE
50    DELTAV=SAVE(IS)*P
      FIRSTV=DELTAV*AINT(Y0/DELTAV+FAD)
      T=FIRSTV+(AXLEN+0.01)*DELTAV
      IF (T-YN)  55,57,57
55    IS=IS+1
      GO  TO  50
57    FIRSTV=FIRSTV-AINT((AXLEN+(FIRSTV-YN)/DELTAV)/2.0)*DELTAV
      IF (Y0*FIRSTV) 58,58,59
58    FIRSTV=0.0
59    IF  (INC) 61,61,65
61    FIRSTV=FIRSTV+AXLEN*DELTAV
      DELTAV=-DELTAV
65    N=N+1
      ARRAY(N)=FIRSTV
      N=N+K
      ARRAY(N)=DELTAV
67    RETURN
70    DELTAV=1.0
      FIRSTV=FIRSTV-0.5
      GO TO 65
      END
./ ADD NAME=SYMBOL   0100-80001-80001-1200-00001-00001-00000-PLOTLIB 00
                                                                           8.1
./ ADD NAME=TSEND    0100-80001-80001-1200-00003-00003-00000-PLOTLIB 00
      SUBROUTINE TSEND
      RETURN
      END
